# 🗺️ 高德地图配置指南

本文档说明了如何在 Flutter 应用中配置和使用高德地图。

## 📋 配置要求

### 1. API Key 配置

已配置的高德地图 API Key: `efbc01099016ed504aa9f3910389fdea`

### 2. Android 配置

已在 `android/app/src/main/AndroidManifest.xml` 中添加：

```xml
<!-- 高德地图API Key -->
<meta-data
    android:name="com.amap.api.v2.apikey"
    android:value="efbc01099016ed504aa9f3910389fdea"/>
```

### 3. 依赖包

已添加到 `pubspec.yaml`：

```yaml
dependencies:
  amap_flutter_map: ^3.0.0 # 高德地图Flutter组件
  amap_flutter_base: ^3.0.0 # 高德地图基础组件
  geolocator: ^10.1.0 # GPS定位服务
```

## 🚀 功能特性

### LocationDisplayScreen 位置显示页面

- ✅ 实时 GPS 定位
- ✅ 高德地图显示
- ✅ 位置标记和信息
- ✅ 地图控制（缩放、指南针、比例尺）
- ✅ 位置详情卡片
- ✅ 定位状态监控
- ✅ 现代化 UI 设计

### 页面功能

1. **自动定位**: 应用启动时自动获取用户位置
2. **地图显示**: 使用高德地图显示当前位置
3. **位置信息**: 显示经纬度、海拔、精度等详细信息
4. **交互控制**: 支持地图缩放、移动和刷新位置
5. **状态反馈**: 实时显示定位状态和进度

## 🔄 页面跳转流程

```
主页 → 倒计时页面 → 位置显示页面
```

1. 用户从主页进入倒计时页面
2. 倒计时结束后自动跳转到位置显示页面
3. 在位置显示页面可以查看当前位置和地图

## 🛠️ 技术实现

### 权限管理

- 自动检查和请求 GPS 定位权限
- 检查 GPS 服务是否开启
- 友好的权限提示和错误处理

### 地图配置

- 隐私合规声明配置
- 地图样式和控件设置
- 用户位置显示和标记
- 地图事件处理

### UI 设计

- Material Design 风格
- 渐变色背景和卡片设计
- 动画反馈和加载状态
- 响应式布局

## 📱 使用说明

1. **确保权限**: 首次使用时需要授予定位权限
2. **开启 GPS**: 确保设备 GPS 定位服务已开启
3. **网络连接**: 地图显示需要网络连接
4. **API 限制**: 注意高德地图 API 的使用限制和配额

## 🔧 故障排除

### 常见问题

1. **地图不显示**: 检查 API Key 是否正确配置
2. **无法定位**: 检查 GPS 权限和服务是否开启
3. **定位精度低**: 在室外空旷地区使用效果更佳
4. **应用崩溃**: 检查依赖版本兼容性

### 调试信息

应用会在控制台输出详细的调试信息，包括：

- 定位状态变化
- 权限检查结果
- 地图加载状态
- 错误详情

## 📄 相关文档

- [高德地图 Flutter 插件文档](https://pub.dev/documentation/amap_flutter_map/latest/)
- [高德地图开放平台](https://lbs.amap.com/)
- [Flutter 定位插件文档](https://pub.dev/packages/geolocator)
